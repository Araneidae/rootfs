ifeq ($(SYSTEM_PYTHON),2)
numpy_VERSION ?= 1.9.2
else
numpy_VERSION ?= 1.16.4
endif

TAR_EXTENSION = .tar.gz
MD5_SUM_1.9.2 = a1ed53432dbcd256398898d35bc8e645
MD5_SUM_1.16.4 = 6edf7334d04d8e8849ad058ccd3b3803

PATCHES_1.9.2 = \
    fix-paths.patch \
    fix-read-only.patch

PATCHES_1.16.4 = \
    avoid-writing-in-sources.patch

ifneq ($(SYSTEM_PYTHON),2)
LIB_DEPENDS = setuptools
endif

define untar-extra
    # files required for testing configuration
    # using a symlinks allows to keep a read-only source directory
    ln -s /tmp/_configtest.c $(srcdir)/_configtest.c
    ln -s /tmp/_configtest.o $(srcdir)/_configtest.o
    ln -s /tmp/_configtest $(srcdir)/_configtest
    # make sure they don't exist, so that they are created
    # after the source directory is made read-only
    rm -rf /tmp/_configtest.c /tmp/_configtest.o /tmp/_configtest
endef

PYTHON_BUILD_TYPE = setuptools


PYTHON_SETUP_ENV += BLAS=None LAPACK=None ATLAS=None

# Note that the variables library_dirs and include_dirs are supported via the
# fix-paths patch applied above.
#
# May also want to add -gfortran for F77 and/or F90 if building the more
# advanced support libraries
ifeq ($(SYSTEM_PYTHON),2)
PYTHON_SETUP_ENV += \
    library_dirs=$(PYTHON_ROOT)/lib \
    include_dirs=$(PYTHON_ROOT)/include
endif

PYTHON_BUILD_OPTS += --fcompiler=None


build:
	$(python-build)
	rm -rf /tmp/_configtest.c /tmp/_configtest.o /tmp/_configtest

install:
	$(install-python-package)


# vim: set filetype=make:
